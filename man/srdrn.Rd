% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/srdrn.R
\name{srdrn}
\alias{srdrn}
\title{Super Resolution CNN for Spatial Downscaling}
\usage{
srdrn(
  input_data,
  target_data,
  time_points = NULL,
  val_input_data = NULL,
  val_target_data = NULL,
  val_time_points = NULL,
  cyclical_period = NULL,
  temporal_basis = c(9, 17, 37),
  temporal_layers = c(32, 64, 128),
  activation = "relu",
  cos_sin_time = FALSE,
  use_batch_norm = FALSE,
  output_channels = 1,
  num_residual_blocks = 3,
  validation_split = 0,
  start_from_model = NULL,
  epochs = 10,
  batch_size = 32,
  seed = NULL
)
}
\arguments{
\item{input_data}{A 3D array of shape (N_1, N_1, n) representing the input data.}

\item{target_data}{A 3D array of shape (N_2, N_2, n) representing the target data.}

\item{time_points}{An optional numeric vector of length n representing the time points associated with each sample.}

\item{val_input_data}{An optional 3D array of shape (N_1, N_1, n) representing the input validation data.}

\item{val_target_data}{An optional 3D array of shape (N_2, N_2, n) representing the target validation data.}

\item{val_time_points}{An optional numeric vector of length n representing the time points of the validation samples.}

\item{cyclical_period}{An optional numeric value representing the cyclical period for time encoding (e.g. 365 for yearly seasonality).}

\item{temporal_basis}{A numeric vector specifying the temporal basis functions to use for time encoding (default is c(9, 17, 37)).}

\item{temporal_layers}{A numeric vector specifying the number of units in each dense layer for time encoding (default is c(128, 256)).}

\item{activation}{A character string specifying the activation function to use (default is "relu").}

\item{cos_sin_time}{A logical value indicating whether to use cosine and sine transformations for time encoding (default is FALSE).}

\item{use_batch_norm}{A logical value indicating whether to use batch normalization in the residual blocks (default is FALSE).}

\item{output_channels}{An integer specifying the number of output channels (default is 1).}

\item{num_residual_blocks}{An integer specifying the number of residual blocks in the model (default is 3).}

\item{validation_split}{A numeric value between 0 and 1 specifying the fraction of the training data to use for validation (default is 0.2).}

\item{start_from_model}{An optional pre-trained Keras model to continue training from (default is NULL).}

\item{epochs}{An integer specifying the number of training epochs (default is 10).}

\item{batch_size}{An integer specifying the batch size for training (default is 32).}

\item{seed}{An optional integer value to set the random seed for reproducibility (default is NULL).}
}
\value{
An object of class SRDRN containing:
\item{model}{The trained Keras model.}
\item{input_mean}{The mean value of the input data used for normalization.}
\item{input_sd}{The standard deviation of the input data used for normalization.}
\item{target_mean}{The mean value of the target data used for normalization.}
\item{target_sd}{The standard deviation of the target data used for normalization.}
\item{input_mask}{A logical array indicating the missing values in the input data.}
\item{target_mask}{A logical array indicating the missing values in the target data.}
\item{min_time_point}{The minimum time point in the input data.}
\item{max_time_point}{The maximum time point in the input data.}
\item{cyclical_period}{The cyclical period used for temporal encoding.}
\item{axis_names}{A list containing the names of the axes (longitude, latitude, time).}
\item{history}{The training history of the model.}
}
\description{
This function implements a Time-aware Super Resolution Deep Neural Network (SRDRN)
for spatial downscaling of grid based data using the TensorFlow and Keras libraries.
The function allows an option for adding a temporal module for spatio-temporal applications.
}
\details{
The Super Resolution Deep Residual Network (SRDRN) implements a deep-learning-based
spatial downscaling approach inspired by Super-Resolution CNNs (SRCNN)
\insertCite{dong2015image}{SpatialDownscaling} and extended for environmental
applications following \insertCite{wang2021deep}{SpatialDownscaling}.

The objective of SRDRN is to learn a mapping from coarse-resolution gridded fields
to finer-resolution targets by combining convolutional feature extraction,
residual learning, and sub-pixel upsampling. The method is designed for both
purely spatial and fully spatio-temporal downscaling when time information is
provided. The method consists of the following main components:

\itemize{
\item \emph{Feature Extraction Block}:
An initial convolutional layer extracts low-level spatial features from the
coarse-resolution input.

\item \emph{Residual Blocks}:
A sequence of residual blocks learn higher-order spatial dependencies.
Residual connections stabilize training and allow deeper representations.

\item \emph{Upsampling Module}:
Sub-pixel convolution (pixel shuffle) layers upscale feature maps to match
the high-resolution target grid.
}

If \code{time_points} are provided, the model includes an auxiliary temporal branch.
Time is encoded either via:
\itemize{
\item Radial basis temporal encodings (\code{temporal_basis}), or
\item Cosine–sine cyclical encodings (\code{cos_sin_time = TRUE}).
}
The encoded temporal features pass through a multilayer perceptron
(\code{temporal_layers}) and are reshaped to spatial form before being concatenated
with CNN features. This enables learning time-varying downscaling dynamics
(e.g., seasonality, long-term trends).
}
\examples{
\dontrun{
# Generate dummy low-resolution (16×16) and high-resolution (32×32) data
n <- 20
input  <- array(runif(16 * 16 * n),  dim = c(16, 16, n))
target <- array(runif(32 * 32 * n),  dim = c(32, 32, n))

# Example 1: Spatial downscaling (no time)
model1 <- srdrn(
  input_data  = input,
  target_data = target,
  epochs = 2,
  batch_size = 4
)

# Example 2: Spatio-temporal downscaling using time points
time_vec <- 1:n
model2 <- srdrn(
  input_data  = input,
  target_data = target,
  time_points = time_vec,
  cyclical_period = 365,
  temporal_layers = c(32, 64),
  epochs = 2,
  batch_size = 4
)
}

}
\references{
\insertAllCited{}
}
